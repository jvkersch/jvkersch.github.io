<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Random musings - The Schwefel function</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Random musings</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jvkersch"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/jvkersch"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">The Schwefel function</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Many optimization algorithms, especially in differential evolution and swarm intelligence, test their performance on a bunch of standard objective functions. Most of these functions are either straightforward (such as the spherical function, which is just the distance to the origin) or very well known (such as the Rastrigin function, which has <a href="https://en.wikipedia.org/wiki/Rastrigin_function">its own Wikipedia page</a>).</p>
<p>One function that stands out as being both somewhat mysterious and not easy to reason about right away is the Schwefel function. The form that is usually described <a href="https://www.sfu.ca/~ssurjano/schwef.html">in the literature</a> has these weird constants in it, and the location of the global minimum likewise is also given numerically as <span class="math inline">\(x_1 = \cdots = x_n = 420.9687\)</span>), to limited precision. This made me curious: what’s up with the Schwefel function? Where did it come from? Can we be more precise about the location of its minima?</p>
</section>
<section id="mathematical-description" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-description">Mathematical description</h2>
<p>The Schwefel function is given by</p>
<p><span class="math display">\[
    F(x) = - \sum_{i = 1}^N x_i \sin \sqrt{|x_i|}.
\]</span></p>
<p>Some references add <span class="math inline">\(418.9829N\)</span> to this expression, so that the global minimum has function value roughly equal to zero. I won’t do that, but I’ll just accept that the function changes with increasing <span class="math inline">\(N\)</span>.</p>
<p>Usually, the Schwefel function is enclosed in a box centered on the origin, of 1000 units on each side, i.e.&nbsp;<span class="math inline">\(-500 \le x_i \le 500\)</span> for all <span class="math inline">\(i = 1, \ldots, N\)</span>. The function has many local minima, as well as one global minimum at <span class="math inline">\(x_1 = \cdots = x_n = 420.9687\)</span>, near the boundary of the domain. This makes it an interesting function to test optimization algorithms on, as it is easy for an algorithm to (a) fail to explore regions near the boundary of the domain, or (b) get stuck in another local minimum.</p>
<p>The Schwefel appears first in a book by (who else) Schwefel from 1977 <span class="citation" data-cites="1977-schwefel-NumerischeOptimierungComputerModellen">(see <a href="#ref-1977-schwefel-NumerischeOptimierungComputerModellen" role="doc-biblioref">Schwefel 1977</a>, problem 2.3 in A1.2)</span> but this book is not often cited. In fact, Google Scholar gives me no citations until 1991, when the evolutionary computing community picked up on it <span class="citation" data-cites="1991-muhlenbein-ParallelGeneticAlgorithm">(<a href="#ref-1991-muhlenbein-ParallelGeneticAlgorithm" role="doc-biblioref">Mühlenbein, Schomisch, and Born 1991</a> is the first reference I could find)</span>. Nowadays, it is used without citation, which is somewhat regrettable since it is not a widely known function.</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> cm</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> schwefel(x, y):</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>x<span class="op">*</span>np.sin(np.sqrt(np.<span class="bu">abs</span>(x))) <span class="op">-</span> y<span class="op">*</span>np.sin(np.sqrt(np.<span class="bu">abs</span>(y)))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span>r, r, <span class="dv">100</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span>r, r, <span class="dv">100</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> schwefel(X, Y)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(subplot_kw<span class="op">=</span>{<span class="st">"projection"</span>: <span class="st">"3d"</span>})</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>surf <span class="op">=</span> ax.plot_surface(X, Y, Z, cmap<span class="op">=</span>cm.coolwarm,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                       linewidth<span class="op">=</span><span class="dv">0</span>, antialiased<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-2-output-1.png" width="411" height="390" class="figure-img"></p>
<p></p><figcaption class="figure-caption">The Schwefel function in 2D.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>I was interested in finding the exact coordinates of the global minimum, as well as the value of the objective function at that point. To get started, observe that <span class="math inline">\(F(x)\)</span> is the sum of a bunch of univariate functions:</p>
<p><span class="math display">\[
    F(x) = f(x_1) + \cdots + f(x_n),
\]</span></p>
<p>where <span class="math inline">\(f(x) = -x \sin\sqrt{|x|}\)</span>. Consequently, the gradient of <span class="math inline">\(F\)</span> is given by</p>
<p><span class="math display">\[
    \nabla F = \left[
        \begin{matrix}
            f'(x_1) \\
            \vdots \\
            f'(x_n)
        \end{matrix}
    \right],
\]</span></p>
<p>where <span class="math inline">\(f'(x)\)</span> is the derivative of <span class="math inline">\(f(x)\)</span>. If we want to find the points where <span class="math inline">\(\nabla F\)</span> vanishes, we therefore have to find the zeros of <span class="math inline">\(f'(x)\)</span>, and solving a one-dimensional equation (even if it is nonlinear) is of course much easier than solving a system of nonlinear equations.</p>
</section>
<section id="finding-the-minima-of-fx" class="level2">
<h2 class="anchored" data-anchor-id="finding-the-minima-of-fx">Finding the minima of <span class="math inline">\(f(x)\)</span></h2>
<p>To find the zeros of <span class="math inline">\(f'(x)\)</span>, we may assume that <span class="math inline">\(x &gt; 0\)</span> (the case <span class="math inline">\(x &lt; 0\)</span> is similar), so that</p>
<p><span class="math display">\[
    f'(x) = - \sin\sqrt{x} - \frac{\sqrt{x}}{2} \cos \sqrt{x} = 0.
\]</span></p>
<p>This equation can be rewritten as</p>
<p><span class="math display">\[
    \tan \sqrt{x} + \frac{\sqrt{x}}{2} = 0,
\]</span></p>
<p>or, by substituting <span class="math inline">\(y = \sqrt{x}\)</span>, as</p>
<p><span class="math display">\[
    -2\tan y = y.
\]</span></p>
<p>In other words, we are looking for the fixed points of the function <span class="math inline">\(g(y) = - 2\tan y\)</span>. There are a few things to keep in mind, though.</p>
<p>By looking at the graph of <span class="math inline">\(-2\tan y\)</span>, we see that there are many fixed points, and in particular, there is one inside each period of the tangent function. We can therefore parametrize these fixed points as <span class="math inline">\(y = z + k \pi\)</span>, where <span class="math inline">\(k\)</span> is an integer and <span class="math inline">\(z \in (-\pi/2, \pi/2)\)</span>. It turns out it will be easier to fix <span class="math inline">\(k\)</span>, and look for <span class="math inline">\(z\)</span> inside one fundamental period of the tangent, by solving</p>
<p><span class="math display">\[
    \tan z = - \frac{z + k \pi}{2}.
\]</span></p>
<p>This equation has a unique fixed point, but it is unstable (since <span class="math inline">\(|g'(y)| &gt; 1\)</span>). To work around this, we take the arctan of both sides to get</p>
<p><span class="math display">\[
    z = - \arctan\left( \frac{z + k \pi}{2} \right).
\]</span></p>
<p>This gives us a fixed-point equation with a unique fixed point that is stable (attracting), so we can solve this e.g.&nbsp;by fixed-point iteration. Once we have a solution <span class="math inline">\(z = z_\text{ext}\)</span>, the corresponding <span class="math inline">\(x\)</span> can then be done by putting</p>
<p><span class="math display">\[
    x_\text{ext} = (z_\text{ext} + k \pi)^2.
\]</span></p>
<p>The fixed-point equation has a few interesting properties:</p>
<ol type="1">
<li>For <span class="math inline">\(k &gt; 0\)</span>, the solution <span class="math inline">\(z_\text{ext}\)</span> will be negative: <span class="math inline">\(z_\text{ext} \in (-\pi/2, 0)\)</span>.</li>
<li>As <span class="math inline">\(k\)</span> increases, <span class="math inline">\(z_\text{ext}\)</span> will tend towards <span class="math inline">\(-\pi/2\)</span>.</li>
</ol>
<p>Both of these properties follow from the graph of the arctan function shifted over <span class="math inline">\(k \pi\)</span> units to the left.</p>
<p>Furthermore, by substituting the expression for the solution back into <span class="math inline">\(f(x)\)</span> and using these sign properties, we get that</p>
<p><span class="math display">\[
    f(x_\text{ext}) = (-1)^k x_\text{ext}\sqrt{\frac{x_\text{ext}}{4 + x_\text{ext}}}.
\]</span></p>
<p>In other words, we get an alternating series of minima (for <span class="math inline">\(k\)</span> odd) and maxima (for <span class="math inline">\(k\)</span> even), whose magnitude increases with increasing <span class="math inline">\(k\)</span>.</p>
<p>The table below lists the first few zeros of <span class="math inline">\(f'(x)\)</span>, together with the value of <span class="math inline">\(f(x)\)</span>.</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> atan, pi</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> fixed_point</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> schwefel_1d(x):</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>x<span class="op">*</span>np.sin(np.<span class="bu">abs</span>(x)<span class="op">**</span><span class="fl">0.5</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solve_fixed_point(k):</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fpe(z):</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">-</span>atan((z <span class="op">+</span> k<span class="op">*</span>pi)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    z_optim <span class="op">=</span> fixed_point(fpe, <span class="dv">0</span>)[()]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    x_optim <span class="op">=</span> (z_optim <span class="op">+</span> k<span class="op">*</span>pi)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x_optim, schwefel_1d(x_optim)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> [(k,) <span class="op">+</span> solve_fixed_point(k) <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">8</span>)]</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    table, </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    headers<span class="op">=</span>[<span class="st">"Index"</span>, <span class="st">"x"</span>, <span class="st">"f(x)"</span>],</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    floatfmt<span class="op">=</span><span class="st">".8f"</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<div id="tbl-zeros" class="anchored">
<table class="table table-sm table-striped">
<caption>Table 1: Extrema and function values for the 1D Schwefel function.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Index</th>
<th style="text-align: right;">x</th>
<th style="text-align: right;">f(x)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.23919930</td>
<td style="text-align: right;">-3.94530163</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">25.87741735</td>
<td style="text-align: right;">24.08296022</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">65.54786509</td>
<td style="text-align: right;">-63.63498195</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">124.82935642</td>
<td style="text-align: right;">122.87617351</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">203.81425265</td>
<td style="text-align: right;">-201.84321788</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">302.52493561</td>
<td style="text-align: right;">300.54455266</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">420.96874636</td>
<td style="text-align: right;">-418.98288727</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">500</span>, <span class="dv">500</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> schwefel_1d(xs)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.plot(xs, ys)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>plt.plot([item[<span class="dv">1</span>] <span class="cf">for</span> item <span class="kw">in</span> table],</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         [item[<span class="dv">2</span>] <span class="cf">for</span> item <span class="kw">in</span> table],</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">"ro"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-4-output-1.png" width="586" height="411" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Extrema of the 1D Schwefel function.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extrema-of-the-schwefel-function" class="level2">
<h2 class="anchored" data-anchor-id="extrema-of-the-schwefel-function">Extrema of the Schwefel function</h2>
<p>This tells us everything we need to know about minima and maxima of <span class="math inline">\(F\)</span>. First of all, we can find all (coordinate-wise positive) extrema of <span class="math inline">\(F(x)\)</span> by finding all of the zeros of the aforementioned fixed-point equation (see <a href="#tbl-zeros">Table&nbsp;1</a>), and then choosing (with replacement) <span class="math inline">\(n\)</span> of these zeros and assembling them into a coordinate vector. Each such <span class="math inline">\(n\)</span>-vector is a zero of <span class="math inline">\(\nabla F\)</span>. In 2D, this gives the distribution of extrema as shown below.</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span>r, r, <span class="dv">100</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="op">-</span>r, r, <span class="dv">100</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x, y)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> schwefel(X, Y)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">7</span>))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>plt.contour(X, Y, Z, levels<span class="op">=</span><span class="dv">20</span>, cmap<span class="op">=</span>cm.coolwarm)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>extrema <span class="op">=</span> np.asarray([item[<span class="dv">1</span>] <span class="cf">for</span> item <span class="kw">in</span> table])</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>Xext, Yext <span class="op">=</span> np.meshgrid(extrema, extrema)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> s(x, y):</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    plt.scatter(x, y, fc<span class="op">=</span><span class="st">'gray'</span>, ec<span class="op">=</span><span class="st">'black'</span>, zorder<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>s(Xext, Yext)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>s(Xext, <span class="op">-</span>Yext)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>s(<span class="op">-</span>Xext, Yext)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>s(<span class="op">-</span>Xext, <span class="op">-</span>Yext)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-5-output-1.png" width="586" height="559" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Extrema of the 1D Schwefel function.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The remaining question is which of these extrema provides the <em>global</em> minimum. First of all, note that <span class="math inline">\(F\)</span> being the sum of <span class="math inline">\(n\)</span> copies of <span class="math inline">\(f\)</span> tells us that the global minimum must have <span class="math inline">\(x_1 = \cdots = x_n = x_\text{min}\)</span>, with <span class="math inline">\(x_\text{min}\)</span> the global minimum of <span class="math inline">\(f(x)\)</span>. So we can reduce our <span class="math inline">\(n\)</span>-dimensional minimization problem to a one-dimensional one, for which we have the fixed point equation.</p>
<p>Secondly, where is <span class="math inline">\(x_\text{min}\)</span> located? For this, we use the expression for the minima and maxima derived earlier. We need to find the largest odd value for <span class="math inline">\(k\)</span> such that <span class="math inline">\(x_\text{ext}\)</span> is still within our domain. Since our domain is limited by <span class="math inline">\(x = 500\)</span>, this gives us <span class="math inline">\(k = 7\)</span>.</p>
<p>Now, we either solve the fixed-point equation for <span class="math inline">\(k = 7\)</span>, or we consult table <a href="#tbl-zeros">Table&nbsp;1</a>. Either way, we get</p>
<p><span class="math display">\[
    x_\text{ext} = (z_\text{ext} + 7 \pi)^2 \approx 420.96874635998194.
\]</span></p>
<p>This is precisely the value quoted in various sources, to greater accuracy.</p>
</section>
<section id="approximate-locations-of-the-extrema" class="level2">
<h2 class="anchored" data-anchor-id="approximate-locations-of-the-extrema">Approximate locations of the extrema</h2>
<p><span class="citation" data-cites="1977-schwefel-NumerischeOptimierungComputerModellen">(<a href="#ref-1977-schwefel-NumerischeOptimierungComputerModellen" role="doc-biblioref">Schwefel 1977</a>)</span> has the following approximate expression for the extrema:</p>
<p><span class="math display">\[
    x_\text{ext} \approx \pm \pi^2\left(\frac{1}{2} + k\right)^2,
\]</span></p>
<p>valid when <span class="math inline">\(k\)</span> is large. This follows easily from the fixed-point equation: for <span class="math inline">\(k\)</span> large, <span class="math inline">\(\arctan\left( \frac{z + k \pi}{2} \right)\)</span> tends to <span class="math inline">\(-\pi/2\)</span>, so that <span class="math inline">\(z_\text{ext} \approx \pi/2\)</span>, and the approximation for <span class="math inline">\(x_\text{ext}\)</span> follows.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-1991-muhlenbein-ParallelGeneticAlgorithm" class="csl-entry" role="doc-biblioentry">
Mühlenbein, H., M. Schomisch, and J. Born. 1991. <span>“The Parallel Genetic Algorithm as Function Optimizer.”</span> <em>Parallel Computing</em> 17 (6): 619–32. <a href="https://doi.org/10.1016/S0167-8191(05)80052-3">https://doi.org/10.1016/S0167-8191(05)80052-3</a>.
</div>
<div id="ref-1977-schwefel-NumerischeOptimierungComputerModellen" class="csl-entry" role="doc-biblioentry">
Schwefel, Hans-Paul. 1977. <em>Numerische <span>Optimierung</span> von <span>Computer-Modellen</span> Mittels Der <span>Evolutionsstrategie</span></em>. First. Interdisciplinary <span>Systems Research</span> 26. <span>Birkhäuser Basel</span>. <a href="https://doi.org/10.1007/978-3-0348-5927-1">https://doi.org/10.1007/978-3-0348-5927-1</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>